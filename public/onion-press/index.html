<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§… Onion Press</title>
    <link rel="stylesheet" href="css/onion-press.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span class="logo-icon">ğŸ§…</span>
                <span class="logo-text">Onion Press</span>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-tab="browse">Browse</button>
                <button class="nav-btn" data-tab="publish">Publish</button>
                <a href="/publish" class="nav-btn" style="text-decoration: none;">ğŸ” Anonymous</a>
                <button class="nav-btn admin-only hidden" data-tab="admin">âš™ï¸ Admin</button>
            </nav>
            <div class="header-actions">
                <button class="settings-btn" id="settingsBtn" title="Show Records From / Publish Records To">
                    âš™ï¸
                </button>
                <div class="tor-status" id="torStatus" title="TOR Status">
                    <span class="tor-indicator"></span>
                    <span class="tor-label">TOR</span>
                </div>
                <button class="login-btn" id="loginBtn">Login</button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- Browse Tab -->
        <section id="browseTab" class="tab-content active">
            <!-- Filters -->
            <div class="filters">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search records..." class="search-input">
                    <button id="searchBtn" class="search-btn">ğŸ”</button>
                </div>
                <div class="filter-group">
                    <select id="typeFilter" class="filter-select">
                        <option value="">All Types</option>
                        <option value="post">ğŸ“° Posts</option>
                        <option value="image">ğŸ–¼ï¸ Images</option>
                        <option value="video">ğŸ¬ Videos</option>
                        <option value="audio">ğŸµ Audio</option>
                        <option value="recipe">ğŸ³ Recipes</option>
                        <option value="exercise">ğŸ‹ï¸ Exercises</option>
                    </select>
                    <select id="sortFilter" class="filter-select">
                        <option value="date:desc">Newest First</option>
                        <option value="date:asc">Oldest First</option>
                        <option value="name:asc">Name A-Z</option>
                        <option value="name:desc">Name Z-A</option>
                    </select>
                </div>
            </div>

            <!-- Records Grid -->
            <div id="recordsContainer" class="records-container">
                <div class="loading">Loading records...</div>
            </div>

            <!-- Pagination -->
            <div class="pagination" id="pagination">
                <button class="page-btn" id="prevBtn" disabled>â† Previous</button>
                <span class="page-info" id="pageInfo">Page 1</span>
                <button class="page-btn" id="nextBtn">Next â†’</button>
            </div>
        </section>

        <!-- Publish Tab -->
        <section id="publishTab" class="tab-content hidden">
            <div class="publish-container">
                <h2>Publish to OIP</h2>
                <p class="publish-description">
                    Use WordPress with the OP Publisher plugin for full authoring capabilities.
                    <a href="/wordpress/wp-admin/" target="_blank" class="wordpress-link">Open WordPress â†’</a>
                </p>
                <div class="wordpress-info">
                    <p>ğŸ“ <strong>WordPress Publishing:</strong> Install and activate the "OP Publisher" plugin in WordPress. 
                    When you publish a post, it will automatically be published to OIP based on your destination settings.</p>
                    <p>ğŸ” <strong>Anonymous Publishing:</strong> Use the <a href="/publish">Anonymous Publisher</a> page for login-less publishing with client-side signing.</p>
                </div>
            </div>
        </section>

        <!-- Admin Tab (requires login) -->
        <section id="adminTab" class="tab-content hidden">
            <div class="admin-container">
                <h2>âš™ï¸ Admin Settings</h2>

                <!-- Publishing Destinations -->
                <div class="settings-section">
                    <h3>ğŸ“¤ Publishing Destinations</h3>
                    <div class="setting-item">
                        <label class="toggle-label">
                            <input type="checkbox" id="adminArweave" class="setting-toggle">
                            <span class="toggle-slider"></span>
                            <span>Publish to Arweave</span>
                        </label>
                        <span class="setting-desc">Permanent blockchain storage</span>
                    </div>
                    <div class="setting-item">
                        <label class="toggle-label">
                            <input type="checkbox" id="adminGun" class="setting-toggle">
                            <span class="toggle-slider"></span>
                            <span>Publish to GUN</span>
                        </label>
                        <span class="setting-desc">Real-time peer synchronization</span>
                    </div>
                    <div class="setting-item">
                        <label class="toggle-label">
                            <input type="checkbox" id="adminIA" class="setting-toggle">
                            <span class="toggle-slider"></span>
                            <span>Publish to Internet Archive (via TOR)</span>
                        </label>
                        <span class="setting-desc">Anonymous submission to IA gateway</span>
                    </div>
                </div>

                <!-- GUN Settings -->
                <div class="settings-section">
                    <h3>ğŸ”„ GUN Synchronization</h3>
                    <div class="form-group">
                        <label for="adminGunPeers">External Peers (comma-separated)</label>
                        <input type="text" id="adminGunPeers" placeholder="https://gun-relay.example.com/gun">
                    </div>
                    <div class="form-group">
                        <label for="adminGunInterval">Sync Interval (ms)</label>
                        <input type="number" id="adminGunInterval" value="30000" min="5000" max="300000">
                    </div>
                    <div class="form-group">
                        <label for="adminGunTrusted">Trusted Nodes (comma-separated public keys)</label>
                        <input type="text" id="adminGunTrusted" placeholder="pubkey1, pubkey2">
                    </div>
                </div>

                <!-- TOR Status -->
                <div class="settings-section">
                    <h3>ğŸ§… TOR Status</h3>
                    <div class="tor-status-box" id="torStatusBox">
                        <div class="tor-status-row">
                            <span>Status:</span>
                            <span id="torConnected" class="status-value">Checking...</span>
                        </div>
                        <div class="tor-status-row">
                            <span>Your .onion address:</span>
                            <span id="torOnionAddr" class="status-value monospace">Loading...</span>
                        </div>
                        <button id="copyOnionBtn" class="small-btn">ğŸ“‹ Copy Address</button>
                    </div>
                </div>

                <!-- Actions -->
                <div class="admin-actions">
                    <button id="saveSettingsBtn" class="primary-btn">ğŸ’¾ Save Settings</button>
                    <button id="resetSettingsBtn" class="secondary-btn">â†º Reset to Defaults</button>
                </div>

                <div id="adminStatus" class="admin-status hidden"></div>
            </div>
        </section>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="closeLoginModal">Ã—</button>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="primary-btn">Login</button>
            </form>
            <div id="loginError" class="error-msg hidden"></div>
        </div>
    </div>

    <!-- Record Detail Modal -->
    <div id="recordModal" class="modal hidden">
        <div class="modal-content large">
            <button class="modal-close" id="closeRecordModal">Ã—</button>
            <div id="recordDetail"></div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="closeSettingsModal">Ã—</button>
            <h2>Show Records From / Publish Records To</h2>
            <p class="settings-description">Select which sources to browse and where to publish records.</p>
            <div class="destinations-settings">
                <label class="destination-setting">
                    <input type="checkbox" id="settingArweave" checked>
                    <span class="dest-icon">â›“ï¸</span>
                    <div class="dest-details">
                        <span class="dest-name">Arweave</span>
                        <span class="dest-desc">Permanent blockchain storage</span>
                    </div>
                </label>
                <label class="destination-setting">
                    <input type="checkbox" id="settingGun" checked>
                    <span class="dest-icon">ğŸ”„</span>
                    <div class="dest-details">
                        <span class="dest-name">GUN Network</span>
                        <span class="dest-desc">Real-time peer sync</span>
                    </div>
                </label>
                <label class="destination-setting">
                    <input type="checkbox" id="settingThisHost">
                    <span class="dest-icon">ğŸ </span>
                    <div class="dest-details">
                        <span class="dest-name" id="thisHostName">This Host</span>
                        <span class="dest-desc" id="thisHostUrl">Loading...</span>
                    </div>
                </label>
            </div>
            <div class="settings-actions">
                <button id="saveSettingsBtn" class="primary-btn">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <span>Onion Press v1.0.0</span>
            <span class="separator">|</span>
            <span>Powered by <a href="https://oip.io" target="_blank">Open Index Protocol</a></span>
            <span class="separator">|</span>
            <span>ğŸ§… Anonymous Publishing</span>
        </div>
    </footer>

    <script src="js/api.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/browse.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>

